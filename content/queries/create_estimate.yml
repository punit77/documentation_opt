queries:
  - id: q1
    title: "Query 1"
    sql: |
      declare @p6 int
      set @p6=0
      exec sp_executesql N'/*DECLARE @SvcOrderID int,@SvcIsValid int,
      @Check int

      SET  @SvcOrderID =:SvcOrderID
      SET  @Check =:Check

      exec [Sp_SvcOrderOpen]  @SvcOrderID,@Check,0, @SvcIsValid output

      Set :RecCount  =@SvcIsValid  */
      DECLARE @SvcOrderID int,@SvcIsValid int,
      @Check int,@OpenedUserID int

      SET  @SvcOrderID =@P1
      SET  @Check =@P2
      SET @OpenedUserID=@P3

      exec [Sp_SvcOrderOpen]  @SvcOrderID,@Check,0,@OpenedUserID, @SvcIsValid output
      Set @P4  =@SvcIsValid',N'@P1 int,@P2 int,@P3 nvarchar(4000),@P4 int OUTPUT',0,1,N'1',@p6 output
      select @p6

  - id: q2
    title: "Query 2"
    sql: |
      SELECT 
        SubStatusID, Description, SchedStatusID, SubStatusColor, IsDefault,
        IsActive, dbo.[GetRowStamp](RecordID) AS RecordID
      FROM
        dbo.tblSchedSubStatus
      WHERE CAST(RecordID AS bigint)>320873146 ORDER BY CAST(RecordID AS bigint)

  - id: q3
    title: "Query 3"
    sql: |
      declare @p3 int
      set @p3=NULL
      exec sp_executesql N'EXEC [spGetSortedPage] ''SELECT TOP 50    CUSTID, CUSTNAME, CONTACT, ALTCONTACT, COMPANYNAME, BILLADDRESS_ADDR2, BILLADDRESS_ADDR3,
                PHONE, ALTPHONE, MOBILE, PAGER, FAX, EMAIL, WEBSITE, CUSTTYPEID, ISACTIVE, SALESREPID,
                BILLADDRESS_CITY, BILLADDRESS_STATE, BILLADDRESS_POSTALCODE, BILLADDRESS_COUNTRY, ALTACCOUNTNO,
                RECORDID, CAMPAIGNID, TERMID, FIRSTNAME, LASTNAME, ONCREDITHOLD, CREDITLIMIT,
                CF1, CF2, CF3, CF4, CF5, CF6, CF7, CF8, CF9, CF10, CF11, CF12, CF13, CF14, CF15,
                CF16, CF17, CF18, CF19, CF20, CF21, CF22, CF23, CF24, CF25, CF26, CF27, CF28, CF29, CF30,
                CUSTSITEID, ISPRIMARY, CUSTSITELINKID
                
      FROM         [VULOOKUPCUSTSELECT]
      '', ''vuLookupCustSelect'', ''CustID'', ''CustName ASC'', 50, 0, ''vuLookupCustSelect.IsActive=1  AND ((vuLookupCustSelect.CustSiteID IS NULL) OR (NOT EXISTS (SELECT CustSiteLinkID, CustID, IsPrimary FROM vuLookupCustSelect AS b WHERE (CustID = vuLookupCustSelect.CustID) AND (CustSiteLinkID < vuLookupCustSelect.CustSiteLinkID))))'', @P1 OUTPUT',N'@P1 int OUTPUT',@p3 output
      select @p3

  - id: q4
    title: "Query 4"
    sql: |
      declare @p3 nvarchar(4000)
      set @p3=N'6353'
      exec sp_executesql N'SET @P1 = CAST((SELECT (Count(*)) AS Value FROM vuLookupCustSelect 
      WHERE vuLookupCustSelect.IsActive=1  AND ((vuLookupCustSelect.CustSiteID IS NULL) OR
       (NOT EXISTS (SELECT CustSiteLinkID, CustID, IsPrimary FROM [vuLookupCustSelect] AS b 
       WHERE (CustID = vuLookupCustSelect.CustID) AND (CustSiteLinkID < vuLookupCustSelect.CustSiteLinkID))))) 
       AS nvarchar(4000))',N'@P1 nvarchar(4000) OUTPUT',@p3 output
      select @p3

  - id: q5
    title: "Query 5"
    sql: |
      SELECT     tblCustomerSite.*,CAST(tblCustomerSite.RecordID AS bigint)
                          AS RecIDInt, [vuSiteWithPrimaryCustID].PrimaryCustID
      FROM         tblCustomerSite LEFT OUTER JOIN
                            [vuSiteWithPrimaryCustID] ON tblCustomerSite.CustSiteID = vuSiteWithPrimaryCustID.vuSiteID

      WHERE tblCustomerSite.CustSiteID=21735

  - id: q6
    title: "Query 6"
    sql: |
      exec sp_executesql N'DECLARE @PartMarkupID int, @LaborRateID int, @CustID int

      SET @CustID = @P1

      SET @PartMarkupID = (SELECT TOP 1 PartMarkupID FROM tblCustPartPricing
      WHERE (CustID = @CustID) AND
            (PartID IS NULL) AND
          (PartMarkupID IS NOT NULL) AND
            (CategoryID IS NULL) AND
            (SubCategoryID IS NULL) AND
            ((DateStarted IS NULL) OR (GETDATE() >= DateStarted)) AND
            ((DateEnded IS NULL) OR (GETDATE() < DateEnded)))

      SET @LaborRateID = (SELECT TOP 1 RateTableID FROM tblCustLaborPricing
      WHERE (CustID = @CustID) AND
            (RepairID IS NULL) AND
          (RateTableID IS NOT NULL) AND
          (CoverageHourID IS NULL) AND
            ((DateStarted IS NULL) OR (GETDATE() >= DateStarted)) AND
            ((DateEnded IS NULL) OR (GETDATE() < DateEnded)))

      SELECT ISNULL(@PartMarkupID,0) AS PartMarkupID, ISNULL(@LaborRateID, 0) AS LaborRateID',N'@P1 int',15100

  - id: q7
    title: "Query 7"
    sql: |
      exec sp_executesql N'DECLARE @AgrmntID int, @Status tinyint, @CheckDate datetime, @CustID int,
        @CustSiteID int, @EquipID int

      SET @AgrmntID = @P1
      SET @Status = ISNULL((SELECT Status FROM tblAgreement WHERE AgrmntID = @AgrmntID), 0)
      SET @CheckDate = @P2
      SET @CustID = @P3
      SET @CustSiteID = @P4
      SET @EquipID = @P5

      IF @EquipID = 0
        SET @EquipID = NULL

      /* we might just check if the customer has an active agrmnt at a given time but if agrmntID is > 0 we just check on that ID, we pass in a date then check if date is active */
      /* we look if it falls between teh start date and a second before teh end date ends */
      SELECT AgrmntID, (CASE WHEN (Status IN (1, 4)) THEN Status
            ELSE (CASE (SELECT COUNT(*) FROM tblAgreement WHERE AgrmntID =
                        (CASE WHEN @AgrmntID > 0 THEN @AgrmntID ELSE AgrmntID END) AND CustID = @CustID AND
                        ((CustSiteID = @CustSiteID) OR (LimitToSite = 0)) AND @CheckDate BETWEEN StartDate AND DATEADD(s, -1, DATEADD(d, 1, EndDate)))
                  WHEN 0 THEN 10 ELSE 2 END)
            END) AS Status,
            /* if we didnt pass in an equip then return top 1 covered equip for this site */
            ISNULL(@EquipID, (SELECT     TOP 1 tblAgrmntEquip.CustEquipID
          FROM         tblAgrmntEquip INNER JOIN
                            tblCustEquip ON tblAgrmntEquip.CustEquipID = tblCustEquip.CustEquipID
          WHERE     (tblAgrmntEquip.AgrmntID = tblAgreement.AgrmntID) AND (tblCustEquip.CustSiteID = @CustSiteID)
          ORDER BY tblAgrmntEquip.LineItemNum)) AS CoveredEquipID
      FROM tblAgreement
      WHERE AgrmntID = (CASE WHEN @AgrmntID > 0 THEN @AgrmntID ELSE AgrmntID END)
            AND CustID = @CustID AND ((CustSiteID = @CustSiteID) OR (LimitToSite = 0)) AND
          ((@AgrmntID > 0) OR (Status = 2)) AND
          /* if we specify an equipment tehn chek if that equip is covered */
                    ((@EquipID IS NULL) OR  (dbo.[fnIsEquipCoveredUnderAgrmnt](@EquipID, tblAgreement.AgrmntID) = 1))
      /* wehn looking for a specific agrmnt tehn return taht agrmnt regardless of the status, 
      but when looking if a site has active agrmnts tehn return only the active agrmnts*/',N'@P1
       int,@P2 datetime2(7),@P3 int,@P4 int,@P5 int',0,'2025-12-01 00:00:00',15100,21735,0
              
          